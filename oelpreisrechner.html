<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ölpreisrechner</title>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; }

    header { background-color: #6EC054; position: relative; padding: 35px 60px; text-align: center; }
    .logo { height: 40px; }
    .back-button { background-color: white; color: #6EC054; padding: 10px 20px; border: none; border-radius: 20px; font-weight: 600; text-decoration: none; transition: background-color 0.3s ease; position: absolute; right: 60px; top: 50%; transform: translateY(-50%); }
    .back-button:hover { background-color: #ffffff; }

    @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    .step-description { font-size: 0.8rem; }

    .form-section { padding: 30px; font-family: 'Segoe UI', sans-serif; background: #ffffff; }
    .form-container { max-width: 1000px; margin: auto; padding: 30px; background: #f1f1f1; border-radius: 16px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05); border: 2px solid #e5e5e5; }
    .form-group { margin-bottom: 14px; }

    label { display: block; font-size: 14px; font-weight: 500; color: #333; margin-bottom: 6px; }

    input[type="text"], select { width: 100%; padding: 8px; font-size: 14px; border: 1px solid #ccc; border-radius: 8px; outline: none; transition: border 0.2s; }
    input[type="text"]:focus, select:focus { border-color: #60993B; }

    #oilRange { width: 100%; appearance: none; height: 8px; background: linear-gradient(to right, #60993B 0%, #ffffff 0%); border-radius: 3px; outline: none; cursor: pointer; }
    #oilRange::-webkit-slider-thumb { appearance: none; height: 18px; width: 18px; border-radius: 50%; background: #60993B; cursor: pointer; margin-top: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); border: none; }
    #oilRange::-moz-range-thumb { height: 18px; width: 18px; border-radius: 50%; background: #6EC054; cursor: pointer; border: none; }

    .value-display { text-align: center; font-size: 16px; font-weight: 600; color: #60993B; border: 2px solid #60993B; padding: 10px 20px; margin: 15px auto 0 auto; border-radius: 8px; display: block; width: 150px; background-color: #f0f9e9; }

    .ticks { display: flex; justify-content: space-between; font-size: 13px; font-weight: 600; color: #444; margin-top: 10px; }

    button { width: 100%; background: #6EC054; color: white; padding: 14px; font-size: 18px; font-weight: 700; border: none; border-radius: 6px; cursor: pointer; transition: background 0.3s; }
    button:hover, button:focus { background: #4c7f2d; outline: none; }

    @media (max-width: 1000px) { .form-container { padding: 20px; } }

    .legend-container { margin-top: 5px; display: flex; gap: 40px; justify-content: center; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-weight: 600; font-size: 0.9rem; color: #333; }
    .legend-item { display: flex; align-items: center; gap: 10px; }
    .line { width: 30px; height: 4px; border-radius: 2px; display: inline-block; animation: pulse-line 2s infinite ease-in-out; }
    .blue { background-color: #007bff; }
    .red { background-color: #dc3545; }
    .yellow { background-color: #ffc107; }
    @keyframes pulse-line { 0%, 100% { transform: scaleX(1); opacity: 0.8; } 50% { transform: scaleX(1.3); opacity: 1; } }

    .footer { margin-top: 40px; padding: 30px 0; text-align: center; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 0.9rem; color: #ffffff; border-top: 1px solid #ddd; background-color: #6EC054; user-select: none; }
    .footer p { margin: 0; }
  </style>
</head>
<body>
  <header>
    <img src="https://onecdn.io/media/61c27ecc-efc9-4840-9ff3-d13f96ec1316/full" alt="Logo" class="logo" />
    <a href="https://www.platzhalter.de" class="back-button">Zurück zur Website</a>
  </header>

  <section style="padding: 1.5rem 1rem; text-align: center; background-color: #ffffff;">
    <h1 style="color: #6EC054; font-size: 2.0rem; margin-bottom: 1rem; animation: fadeInDown 0.6s ease-out;">
      Heizöl Preisrechner – Raiffeisenmarkt Wiesbach im Saarland
    </h1>
    <p style="font-size: 1.2rem; color: #333; max-width: 1000px; margin: 0 auto; animation: fadeInUp 0.6s ease-out;">
      Berechnen Sie Ihren Heizölpreis schnell und bequem – ganz einfach online und sofort verfügbar.
    </p>
  </section>

  <section aria-label="Schritte zum Ölpreisrechner" style="background:#ffffff; color:#333; max-width:1000px; margin:1.5rem auto; padding:0.5rem 1.5rem; border-radius:8px; box-shadow:0 2px 8px rgb(0 0 0 / 0.05);">
    <ol style="list-style:none; counter-reset:step; padding:0; margin:0;">
      <li style="display:flex; align-items:flex-start; gap:1rem; margin-bottom:1.5rem;">
        <div aria-hidden="true" style="counter-increment:step; width:2.5rem; height:2.5rem; background:#6EC054; color:#ffffff; border-radius:50%; display:flex; justify-content:center; align-items:center; font-weight:700; font-size:1.25rem;">1</div>
        <div>
          <strong>Daten eingeben</strong><br />
          <span class="step-description">PLZ, Liefermenge &amp; Versandart wählen</span>
        </div>
      </li>
      <li style="display:flex; align-items:flex-start; gap:1rem; margin-bottom:1.5rem;">
        <div aria-hidden="true" style="counter-increment:step; width:2.5rem; height:2.5rem; background:#6EC054; color:#ffffff; border-radius:50%; display:flex; justify-content:center; align-items:center; font-weight:700; font-size:1.25rem;">2</div>
        <div>
          <strong>Preis berechnen</strong><br />
          <span class="step-description">Individuellen Preis berechnen lassen</span>
        </div>
      </li>
      <li style="display:flex; align-items:flex-start; gap:1rem; margin-bottom:1.5rem;">
        <div aria-hidden="true" style="counter-increment:step; width:2.5rem; height:2.5rem; background:#6EC054; color:#ffffff; border-radius:50%; display:flex; justify-content:center; align-items:center; font-weight:700; font-size:1.25rem;">3</div>
        <div>
          <strong>Bestellung abschicken</strong><br />
          <span class="step-description">Persönliche Daten bestätigen &amp; Formular verbindlich absenden</span>
        </div>
      </li>
      <li style="display:flex; align-items:flex-start; gap:1rem;">
        <div aria-hidden="true" style="counter-increment:step; width:2.5rem; height:2.5rem; background:#6EC054; color:#ffffff; border-radius:50%; display:flex; justify-content:center; align-items:center; font-weight:700; font-size:1.25rem;">4</div>
        <div>
          <strong>Lieferung &amp; Zahlung</strong><br />
          <span class="step-description">Bezahlung bei Lieferung oder per Vorabüberweisung</span>
        </div>
      </li>
    </ol>
  </section>

  <section class="form-section">
    <div class="form-container">
      <form id="oilForm">
        <div class="form-group">
          <label for="oilRange">Liefermenge (Liter)</label>
          <input type="range" id="oilRange" min="100" max="15000" step="100" value="500" oninput="updateSlider(this)">
          <div class="ticks">
            <span>100</span>
            <span>5.000</span>
            <span>10.000</span>
            <span>15.000</span>
          </div>
          <div class="value-display" id="oilValue"></div>
        </div>

        <div class="form-group">
          <label for="plz">Postleitzahl</label>
          <input type="text" id="plz" name="plz" maxlength="5" inputmode="numeric" pattern="\d{5}" required placeholder="z. B. 66557">
        </div>

        <div class="form-group">
          <label for="ablade">Anzahl der Abladestellen</label>
          <select id="ablade" name="ablade" required>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>

        <button type="submit">Preis berechnen</button>
      </form>
    </div>
  </section>

  <script>
    const oilSlider = document.getElementById('oilRange');
    const oilValue = document.getElementById('oilValue');

    function updateSlider(slider) {
      const value = parseInt(slider.value);
      oilValue.textContent = value.toLocaleString('de-DE') + ' Liter';
      const min = parseInt(slider.min);
      const max = parseInt(slider.max);
      const percent = ((value - min) / (max - min)) * 100;
      slider.style.background = `linear-gradient(to right, #60993B 0%, #60993B ${percent}%, #e0e0e0 ${percent}%, #e0e0e0 100%)`;
    }

    updateSlider(oilSlider);

    // HINWEIS: In area2 und area3 gibt es Überschneidungen (z. B. 66129, 66130, 66780, 66798, 66802).
    // Entscheide, welche Area Vorrang hat, oder bereinige die Listen.
    const area1 = ["66260","66262","66265","66272","66273","66274","66275","66280","66281","66282","66284","66287","66288","66289","66292","66293","66294","66295","66299","66337","66338","66340","66341","66346","66511","66512","66513","66514","66515","66516","66517","66518","66519","66520","66521","66522","66531","66538","66539","66540","66549","66550","66552","66553","66557","66558","66559","66560","66564","66565","66566","66567","66571","66572","66573","66575","66578","66579","66580","66583","66584","66585","66587","66589","66591","66592","66593","66594","66595","66596","66597","66630","66631","66632","66633","66636","66641","66642","66643","66646","66791","66792","66793","66807","66809","66811","66812","66813","66814","66819","66822","66832","66833","66835","66836","66839"];
    const area2 = ["66459","66640","66629","66701","66740","66763","66773","66774","66775","66777","66787","66780","66794","66795","66798","66802","66000","66001","66002","66003","66004","66005","66006","66007","66008","66009","66010","66011","66012","66013","66014","66015","66016","66017","66019","66020","66021","66022","66023","66024","66025","66026","66027","66028","66029","66030","66031","66032","66033","66042","66043","66044","66045","66046","66047","66051","66053","66055","66057","66059","66060","66061","66063","66065","66067","66090","66091","66092","66093","66094","66095","66099","66100","66101","66102","66103","66104","66105","66106","66107","66108","66109","66111","66113","66115","66117","66119","66121","66123","66125","66126","66127","66128","66129","66130","66131","66132","66133","66140","66141","66142","66143","66150","66200","66259","66353","66354","66355","66359","66361","66362","66363","66364","66365","66366","66367","66368","66369","66370","66376","66377","66386","66803","66804","66806","66333"];
    const area3 = ["66687","66129","66130","66629","66271","66352","66399","66424","66679","66693","66706","66709","66780","66798","66802","66440","66453","66620","66625","66663"];

    document.getElementById('oilForm').addEventListener('submit', function(event) {
      event.preventDefault();

      const menge = parseInt(oilSlider.value);
      const plz = document.getElementById('plz').value.trim();
      const ablade = document.getElementById('ablade').value;

      let area = '';
      if (area1.includes(plz)) area = 'Area 1';
      else if (area2.includes(plz)) area = 'Area 2';
      else if (area3.includes(plz)) area = 'Area 3';
      else { alert('Die eingegebene PLZ liegt nicht im Liefergebiet.'); return; }

      fetch('https://n8n.srv899952.hstgr.cloud/webhook/oelrechner', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
  body: JSON.stringify({ liefermenge: menge, plz, abladestellen: ablade, area })
})
.then(async (response) => {
  const data = await response.json().catch(() => null);
  if (!response.ok || !data) throw new Error('Fehlerhafte Serverantwort');
  const result = Array.isArray(data) ? data[0] : data;

  sessionStorage.setItem('oelForm', JSON.stringify({
    eingabe: { liefermenge: menge, plz, abladestellen: ablade, area },
    berechnung: result,
    timestamp: Date.now()
  }));

  window.location.href = './seite2.html';
})
.catch(err => {
  console.error(err);
  alert('Fehler beim Senden oder Lesen der Antwort.');
});
  </script>

  <div style="max-width: 1000px; width: 100%; margin: 40px auto; padding: 20px; background: #ffffff; border-radius: 16px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1); overflow: hidden;">
    <div style="position: relative; padding-bottom: 56.25%; height: 0;">
      <iframe
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSgDaArv9UgKthAI2xg0BfJXxqJ6yUCqQZzlbytuz4KAUEPXKAeyteb45S943v2a_Hq4E2XAvidKalW/pubchart?oid=1568395756&amp;format=interactive"
        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 12px; transform: translateX(-50px);"
        frameborder="0" scrolling="no" seamless>
      </iframe>
    </div>
  </div>

  <div class="legend-container">
    <p class="legend-item"><span class="line blue"></span> Preisentwicklung 7 Tage</p>
    <p class="legend-item"><span class="line red"></span> Preisentwicklung 14 Tage</p>
    <p class="legend-item"><span class="line yellow"></span> Preisentwicklung 90 Tage</p>
  </div>

  <footer class="footer">
    <p>© 2025 Raiffeisenmarkt Wiesbach – Alle Rechte vorbehalten</p>
  </footer>
</body>
</html>
